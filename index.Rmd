---
title: "Income and Right to Work in the United States"
output: html_document:
  keep_md: true
group: Evan L, Evan M, Darcy, Ana, and Caz
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warnings = FALSE)
#Pulling packages needed for initial analysis
install.packages("pacman", repos = "http://cran.us.r-project.org")
library("pacman")
pacman::p_load("haven", "ggplot2", "scales", 
               "dplyr", "magrittr", "ggthemes")
```

# Dataset
###### We are drawing our data from a subsample of the American Community Survey (ACS) data from the year 2016. The ACS is a survey conducted annually by the U.S. Census Bureau, gathering long-form information previously collected in the Decennial (conducted in years ending 0) Census. 

# Policy Analysis
######  Right to Work (RTW) refers to state laws that prohibit unions from compelling individuals to join, or pay union dues as condition for employment.. In addition, Right to Work  laws often prohibit contracts that mandate only hiring a unionized workforce. 


###### Although Right to Work laws may seem beneficial to some, critics argue that they are inherently “anti-union.” Due to the existence of  federal laws that prevent mandatory union membership, and some argue that Right to Work laws harm unions’ bargaining strength, subsequently lowering salaries and benefits for vulnerable workers.




## Purpose of Analysis
###### Our analysis aims to contribute to this discussion of Right to Work.  We aim to consider the relationship between Right to Work laws and outcomes for workforce in terms of income.  
  + $H_{0}$ = There is no significant difference in the means of income wages in states with RTW and without RTW. 
  + $H_{1}$ = There is a significant difference in the means of income wage in states with RTW and without RTW.  


```{r}
dataset <- 'https://github.com/EvanLih/PUBPOL599_Right_To_Work/raw/master/Dataset/Cleaned_RTW_Dataset.csv'
dataset <- read.csv(dataset, stringsAsFactors = F) 
dataset$Right_to_Work %<>% as.factor
```

```{r}
#converting the Right_to_Work column into as a factor, as it is currently being read as a integer. 
means <- aggregate(incwage ~ Right_to_Work, dataset, mean)
means$incwage %<>% round(2)

#I use the "suppressMessages" command so that the errors generated by ggplot are not printed out in our markdown file. However, because ggplot does not generate messages, we need to make sure to include the "print" command. 
suppressMessages(print(ggplot(dataset, aes(Right_to_Work, incwage, fill = Right_to_Work, show.legend = FALSE), group = Right_to_Work) +
  geom_boxplot(outlier.color = "red", outlier.shape = NA) +
  scale_y_continuous(breaks = c(10000,30000,50000,70000,100000), labels = dollar) +
  ylim(0,150000) +
  labs(x = "Right to Work", y = "Income (Dollars)") +
  geom_text(data=means, aes(label = incwage, y = incwage + .09)) +
  scale_x_discrete(breaks= c(0,1), labels = c("No Right to Work", "Right to Work")) +
  scale_fill_manual(values = c("dodgerblue4", "indianred4")) +
  labs(title = "Median Income by Right to Work Status") +
  theme_stata() +
  scale_color_stata()+
  theme(plot.subtitle=element_text(size=10, hjust=0.5, color="black")) +
  theme(plot.title=element_text(size=19, face="bold", hjust = .5)) +
  theme(axis.title.x=element_text(face = "bold", size = 10)) +
  theme(axis.title.y = element_text(face = "bold", size = 10)) +
  theme(axis.text.y = element_text(angle = 45)) +
  theme(legend.title=element_blank()) + 
  guides(fill=FALSE)))

LinRegwage = lm(incwage ~ Right_to_Work, data = dataset)
summary(LinRegwage)

```

```{r}
ggplot(dataset, aes(Right_to_Work, incwage, fill = Right_to_Work), group = Right_to_Work) +
  geom_bar(stat = "summary", fun.y = "mean", position = position_dodge(width = 2.0), width = .7) +
  labs(x = "Right to Work", y = "Income (dollars)") +
  scale_x_discrete(breaks= c(0,1), labels = c("No RTW", "Has RTW")) +
  scale_y_continuous(breaks = c(10000,20000,30000,40000,50000,60000), labels = dollar) +
  scale_fill_manual(name= "Right to Work Status", labels=c("No Right to Work", "Right to Work"),
                    values = c("dodgerblue4", "indianred4")) +
  facet_grid(. ~ sex) +
  labs(title = "Average Income by Sex", subtitle = "Divided by Right to Work/ No Right to Work") +
  theme_stata() +
  scale_color_stata()+
  theme(plot.subtitle=element_text(size=10, hjust=0.5, color="black")) +
  theme(plot.title=element_text(size=19, face="bold", hjust = .5)) +
  theme(axis.title.x=element_text(face = "bold", size = 10)) +
  theme(axis.title.y = element_text(face = "bold", size = 10)) +
  theme(axis.text.y = element_text(angle = 45))

incSexMeans <- dataset %>% group_by(sex, Right_to_Work) %>% summarise(mean = mean(incwage))

print(incSexMeans)

```

For Females in states with no RTW laws, the average income is __35929__, while females in states with RTW laws earn __29113__. 
For Males in states with no RTW laws, the average income is __57619__, while males in states with RTW earn __49021__. 
These results shows that the presence of RTW laws effect both male and female income earnings. 
```{r}
incSex <- t.test(incwage~sex, data = dataset)
print(incSex)
```
This t-test shows if there is a significant difference in the mean values of income between Males and Females. With a P-value of 2.2e-16, we can safely reject the null hypothesis that there is no difference in the mean values of income between Males and Females. 

### Our results are **Significant**;
On average, all else equal, being an RTW State is associated with a decrease of USD 7736.112 in the wage income. Also, on average, all else equal, one more year in age is associated with an increase of approximately USD 71 in annual wages. 

```{r}
testRTW=lm(as.numeric(incwage)~Right_to_Work+age,data=dataset)
summary(testRTW)
```

Our adjusted R-squared for this regression is small...
```{r}
summary(testRTW)$adj.r.squared
```

```{r}
ggplot(dataset, aes(age, incwage, show.legend=TRUE)) +
  stat_summary(fun.y="mean",geom="point")+
  labs(x = "Age", y = "Income (dollars)") +
  scale_y_continuous(breaks=seq(10000,60000,by=10000), labels = dollar)+
  facet_grid(. ~ Right_to_Work)+
  labs(title="Average Income by Age by RTW Status", caption = "IPUMS", subtitle = "0=No RTW, 1= RTW") +
  theme_stata() +
  scale_color_stata()+
  theme(plot.subtitle=element_text(size=10, hjust=0.5, color="black")) +
  theme(plot.title=element_text(size=13, face="bold", hjust = .5)) +
  theme(axis.title.x=element_text(face = "bold", size = 10)) +
  theme(axis.title.y = element_text(face = "bold", size = 10)) +
  theme(axis.text.y = element_text(angle = 45))
```




##### The p-value for the interaction between sex*Right_to_Work is <2e-16 (significant), which indicates that the relationships between Right to Work and income length depends on gender - if the individual is male or female. 
```{r}
t.test(incwage~Right_to_Work, data = dataset)

#aov means anove test. We are testing the dependent variable(sex), on its relationship to the independent variables of sex and right to work. the order of the variables in the code (sex*Right_to_Work) is important). 
summary(aov(incwage ~ sex*Right_to_Work, data = dataset))


```



#Conclusion
We found that there is a strong correlation between Right to Work and no Right to Work regarding income. We found compelling evidence to suggest that further significance when we consider sex and age as other explanatory variables. 



